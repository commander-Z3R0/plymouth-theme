#!/bin/bash
set -e

USER="sirr"
USER_HOME="/home/$USER"
GTK_CONFIG_DIR="$USER_HOME/.config/gtk-3.0"
GTK_CSS_FILE="$GTK_CONFIG_DIR/gtk.css"
WALLPAPER_PATH="/usr/share/backgrounds/wallpaper_sirros.png"

# Create the gtk-3.0 directory if it does not exist
if [ ! -d "$GTK_CONFIG_DIR" ]; then
  mkdir -p "$GTK_CONFIG_DIR"
  chown $USER:$USER "$GTK_CONFIG_DIR"
fi

# Create or overwrite gtk.css with the desired content
cat > "$GTK_CSS_FILE" << EOF
/*
 * Set a background for the lockscreen.
 */
phosh-lockscreen, .phosh-lockshield {
  background-image: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)),
                    url('file://$WALLPAPER_PATH');
  background-size: cover;
  background-position: center;
}

/*
 * Set a background for the app grid.
 */
phosh-app-grid {
  background-image: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)),
                    url('file://$WALLPAPER_PATH');
  background-size: cover;
  background-position: center;
}
EOF

# Apply correct user/group ownership to gtk.css
chown $USER:$USER "$GTK_CSS_FILE"

exit 0
